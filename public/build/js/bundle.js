$((function(){var e=$("body");function i(e,i){var t=activeTabId.split("_")[0];$("#"+t+"_id_meliscms_tool_sites_script_exceptions").append('<div id="loader" class="overlay-loader"><img class="loader-icon spinning-cog" src="/MelisCore/assets/images/cog12.svg" data-cog="cog12"></div>'),$.ajax({type:"POST",url:"/melis/MelisCmsPageScriptEditor/MelisCmsPageScriptEditorToolSiteEdition/saveSiteScriptException",data:{siteId:t,operation:e,tool_site_mcse_page_id:i},dataType:"json",encode:!0}).done((function(e){$("#"+t+"_id_meliscms_tool_sites_script_exceptions #loader").remove(),e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),$("#"+t+"_id_meliscms_tool_sites_script_content").find("#"+t+"tool_site_exception_page_id").removeClass("tool-site-page-exception-error"),melisHelper.zoneReload(t+"_id_meliscms_tool_sites_script_exceptions","meliscms_tool_sites_script_exceptions",{siteId:t}),$("#"+t+"_id_meliscms_tool_sites_script_content").find("#"+t+"tool_site_exception_page_id").val("")):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),$("#"+t+"_id_meliscms_tool_sites_script_content").find("#"+t+"tool_site_exception_page_id").addClass("tool-site-page-exception-error"))})).fail((function(){alert(translations.tr_meliscore_error_message)}))}function t(){var e=activeTabId.split("_")[0],i=null;return $("#"+e+"MelisCmsPageScriptEditorScriptExceptionsTable").length>0&&(i=$("#"+e+"MelisCmsPageScriptEditorScriptExceptionsTable").DataTable()),i}e.on("click",".melis-cms-page-script-checkbox input[type=checkbox]",(function(){$(this).parent().find(".cbmask-inner").toggleClass("cb-active")})),e.on("click",".btnDeletePageException",(function(e){var s=null,o=t(),c=$(this).parents("tr").attr("class");s="child"==c?o.row($(this).closest("tr").prev()[0]).data().mcse_page_id:o.row($(this).closest("tr")).data().mcse_page_id,melisCoreTool.confirm(translations.tr_meliscmspagescripteditor_common_label_yes,translations.tr_meliscmspagescripteditor_common_label_no,translations.tr_meliscmspagescripteditor_delete_exception_btn_tooltip,translations.tr_meliscmspagescripteditor_delete_exception_btn_confirm,(function(){i("delete",s)}))})),e.on("click",".add_tool_site_script_exception_btn",(function(e){var t=activeTabId.split("_")[0];i("add",$("#"+t+"tool_site_exception_page_id").val())})),window.initSiteId=function(e){var i=activeTabId.split("_")[0];isNaN(i)||(e.siteId=i)},window.scriptExceptionsCallback=function(){var e=activeTabId.split("_")[0],i=$("#"+e+"MelisCmsPageScriptEditorScriptExceptionsTable_wrapper"),s=i.find(".dt-length"),o=s.find("select"),c=i.find(".dt-info"),a=i.find(".dt-search"),n=i.find(".dt-paging");t().data().count()<=parseInt(o.find("option:first-child").val())?(s.hide(),c.hide(),a.hide(),n.hide()):(s.show(),c.show(),a.show(),n.show())}}));
